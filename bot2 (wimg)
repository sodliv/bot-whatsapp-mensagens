import pandas as pd
import pywhatkit
import time

# pega os dados na panilha
df = pd.read_excel("C:\\Users\\smlima\\AppData\\Local\\Microsoft\\WindowsApps\\Contatos_dependentes.xlsx")

# caminho img
imagem = "C:\\Users\\smlima\\AppData\\Local\\Microsoft\\WindowsApps\\imagemdependentes.jfif"

# msg
mensagem_base = """Ol√°, {nome}. Estamos preparando uma homenagem especial para celebrar o Dia dos Pais, e a sua participa√ß√£o √© fundamental!

Para isso, pedimos que voc√™:
* Envie uma foto sua com seu(s) filho(s);
* Complete a frase "Ser pai √©...";
* Informe seu nome, o nome do(s) seu(s) filho(s) e a unidade Bundy.

üìÖ Nos envie as informa√ß√µes at√© 31/07, pelo google forms.

√â s√≥ clicar no link abaixo:
https://forms.gle/1y4Xqkm9RvvQEPnC9

Aguardamos sua¬†resposta!¬†ü•∞"""

# Loop p envio
for index, row in df.iterrows():
    nome = row["Nome"]
    telefone = str(row["Telefone"])

    mensagem = mensagem_base.format(nome=nome)

    try:
        pywhatkit.sendwhats_image(
            receiver=f"+{telefone}",
            img_path=imagem,
            caption=mensagem,
            wait_time=600,
            tab_close=True,
            close_time=2
        )

        print(f"‚úÖ Imagem enviada para {nome} ({telefone})")
        time.sleep(2)  # Aguarda antes do pr√≥ximo

    except Exception as e:
        print(f"‚ùå Erro com {nome} ({telefone}): {e}")
